@{
	ViewBag.Title = "D3.js";
}

@section css
{
	li {
		padding-left: 10px;
	}
}

@section header
{
	<h2 class="page-title">Data-Driven Documents<small> is a JavaScript library for manipulating documents based on data.</small></h2>
}

<div ng-app="mindMapApp" ng-controller="mindMapCtrl">
	<div class="row" style="font-size: 16px;">
		<div class="col-md-4">
			<ul>
				<li ng-repeat="node in nodes" ng-include="'../templates/treeView.html'"></li>
			</ul>
		</div>

		<div class="col-md-8">
			graph holder
		</div>
	</div>
</div>

@section scripts
{
	<script>
		'use strict';

		(function(ng) {
			var app = ng.module('mindMapApp', []);

			app.factory('nodeRepository', function() {
				var nodes = [
					{
						value: 'root',
						childs: []
					}
				];

				return {
					getAll: function() {
						return nodes;
					},
					add: function(node, val) {
						if (!node.childs) {
							node.childs = [];
						}
						var obj = {
							childs: [],
							value: val
						};
						node.childs.push(obj);
					},
					del: function(node) {
						node.childs = [];
					}
				};
			});

			app.controller('mindMapCtrl', ['$scope', 'nodeRepository', function($scope, nodeRepo) {
				$scope.nodes = nodeRepo.getAll();

				$scope.add = function(node) {
					nodeRepo.add(node, 'some text...');
				};
				
				$scope.del = function (node) {
					nodeRepo.del(node);
				};
			}]);

		})(angular);
	</script>
}